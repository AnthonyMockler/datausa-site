{% extends "templates/nav.html" %}

{% block body %}

<div id="search-advanced">
  <div id="search-filters">
    <a href="#" class="search-filter" data-filter="">All</a>
    <a href="#" class="search-filter" data-filter="geo">Locations</a>
    <a href="#" class="search-filter" data-filter="naics">Industries</a>
    <a href="#" class="search-filter" data-filter="soc">Occupations</a>
    <a href="#" class="search-filter" data-filter="cip">Education Majors</a>
  </div>
  <div class="search-nav">
    <input class="search-input" data-search="advanced" type="text" placeholder="Search DataUSA&hellip;" autofocus />
    <div class="search-crumbs">
      <div class="search-back" onclick="search.back();"><i class="fa fa-angle-left"></i></div>
    </div>
  </div>
  <div class="search-results"></div>
</div>

{% endblock %}

{% block js %}
<script>

  /*
   * Constrain search to specific types of attrs
   */
  d3.selectAll(".search-filter").on("click", function(){
    
    search.term = "";
    search.type = d3.select(this).attr("data-filter");
    search.reload();
    
    // prevent default anchor link behavior
    d3.event.preventDefault();
  })

  var term = location.search ? location.search.split("=")[1] : "";
  search.term = term.replace(/%20/g, " ");
  search.advanced = true;
  search.container = d3.select("#search-advanced");

  var input = d3.select(".search-input").attr("value", search.term);
  if (input.node().setSelectionRange !== undefined) {
    input.node().setSelectionRange(search.term.length, search.term.length);
  }

  search.reload();

</script>
{% endblock %}
